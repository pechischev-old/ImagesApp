(function(){var e=this;function aa(a,b,c){return a.call.apply(a.bind,arguments)}function ba(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function f(a,b,c){f=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?aa:ba;return f.apply(null,arguments)};var g=String.prototype.trim?function(a){return a.trim()}:function(a){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")};function h(a,b){return a<b?-1:a>b?1:0}function ca(a){return String(a).replace(/\-([a-z])/g,function(a,c){return c.toUpperCase()})}function da(a){var b="\\s";return a.replace(new RegExp("(^"+(b?"|["+b+"]+":"")+")([a-z])","g"),function(a,b,p){return b+p.toUpperCase()})};function l(a,b){this.x=void 0!==a?a:0;this.y=void 0!==b?b:0}l.prototype.clone=function(){return new l(this.x,this.y)};l.prototype.ceil=function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this};l.prototype.floor=function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this};l.prototype.round=function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this};function m(a,b){this.width=a;this.height=b}m.prototype.clone=function(){return new m(this.width,this.height)};m.prototype.ceil=function(){this.width=Math.ceil(this.width);this.height=Math.ceil(this.height);return this};m.prototype.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};m.prototype.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};function n(a,b,c,d){this.left=a;this.top=b;this.width=c;this.height=d}n.prototype.clone=function(){return new n(this.left,this.top,this.width,this.height)};n.prototype.ceil=function(){this.left=Math.ceil(this.left);this.top=Math.ceil(this.top);this.width=Math.ceil(this.width);this.height=Math.ceil(this.height);return this};n.prototype.floor=function(){this.left=Math.floor(this.left);this.top=Math.floor(this.top);this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};
n.prototype.round=function(){this.left=Math.round(this.left);this.top=Math.round(this.top);this.width=Math.round(this.width);this.height=Math.round(this.height);return this};function ea(){var a=new n(200,200,250,250);this.c=new m(a.width,a.height);this.b=new l(a.left,a.top)};function fa(){this.b=[]}function t(a){var b=new ea;a.b.push(b);return new n(b.b.x,b.b.y,b.c.width,b.c.height)};var u;a:{var v=e.navigator;if(v){var w=v.userAgent;if(w){u=w;break a}}u=""};var x=-1!=u.indexOf("Opera")||-1!=u.indexOf("OPR"),y=-1!=u.indexOf("Trident")||-1!=u.indexOf("MSIE"),ga=-1!=u.indexOf("Edge"),z=-1!=u.indexOf("Gecko")&&!(-1!=u.toLowerCase().indexOf("webkit")&&-1==u.indexOf("Edge"))&&!(-1!=u.indexOf("Trident")||-1!=u.indexOf("MSIE"))&&-1==u.indexOf("Edge"),A=-1!=u.toLowerCase().indexOf("webkit")&&-1==u.indexOf("Edge");function B(){var a=e.document;return a?a.documentMode:void 0}var C;
a:{var D="",E=function(){var a=u;if(z)return/rv\:([^\);]+)(\)|;)/.exec(a);if(ga)return/Edge\/([\d\.]+)/.exec(a);if(y)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(a);if(A)return/WebKit\/(\S+)/.exec(a);if(x)return/(?:Version)[ \/]?(\S+)/.exec(a)}();E&&(D=E?E[1]:"");if(y){var F=B();if(null!=F&&F>parseFloat(D)){C=String(F);break a}}C=D}var G={};
function H(a){if(!G[a]){for(var b=0,c=g(String(C)).split("."),d=g(String(a)).split("."),p=Math.max(c.length,d.length),k=0;0==b&&k<p;k++){var ha=c[k]||"",ia=d[k]||"",ja=RegExp("(\\d*)(\\D*)","g"),ka=RegExp("(\\d*)(\\D*)","g");do{var q=ja.exec(ha)||["","",""],r=ka.exec(ia)||["","",""];if(0==q[0].length&&0==r[0].length)break;b=h(0==q[1].length?0:parseInt(q[1],10),0==r[1].length?0:parseInt(r[1],10))||h(0==q[2].length,0==r[2].length)||h(q[2],r[2])}while(0==b)}G[a]=0<=b}}
var I=e.document,la=I&&y?B()||("CSS1Compat"==I.compatMode?parseInt(C,10):5):void 0;var J;if(!(J=!z&&!y)){var K;if(K=y)K=9<=Number(la);J=K}J||z&&H("1.9.1");y&&H("9");function L(a){this.f=a;this.b()}function M(a,b){a.a.onclick=b}L.prototype.c=function(){return this.a};L.prototype.b=function(){this.a=document.createElement("BUTTON");this.a.setAttribute("class","button");this.a.innerHTML=this.f};function N(){this.b();this.a=[]}function O(a,b){a.a.push(b);a.f.appendChild(b.c())}N.prototype.c=function(){return this.f};N.prototype.b=function(){this.f=document.createElement("DIV");this.f.setAttribute("id","toolbar")};function P(){this.b()}P.prototype.c=function(){return this.a};P.prototype.b=function(){this.a=document.createElement("INPUT");this.a.id="imageInput";this.a.type="text";this.a.setAttribute("value","\u0412\u0432\u0435\u0434\u0438\u0442\u0435 Url \u0438\u043b\u0438 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0439 \u0430\u0434\u0440\u0435\u0441 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0438");this.a.onfocus=f(this.f,this)};P.prototype.f=function(){this.a.setAttribute("value","")};function Q(a,b,c){if("string"==typeof b)(b=R(a,b))&&(a.style[b]=c);else for(var d in b){c=a;var p=b[d],k=R(c,d);k&&(c.style[k]=p)}}var S={};function R(a,b){var c=S[b];if(!c){var d=ca(b),c=d;void 0===a.style[d]&&(d=(A?"Webkit":z?"Moz":y?"ms":x?"O":null)+da(d),void 0!==a.style[d]&&(c=d));S[b]=c}return c};function T(a,b){this.g=b;this.f=a;this.b()}T.prototype.c=function(){return this.a};T.prototype.b=function(){this.a=document.createElement("DIV");this.a.setAttribute("class","capture");Q(this.a,"top",this.f.top+"px");Q(this.a,"left",this.f.left+"px");var a=document.createElement("IMG");a.setAttribute("src",this.g);a.setAttribute("alt","\u0442\u0435\u043a\u0441\u0442");Q(a,"width",this.f.width+"px");Q(a,"height",this.f.height+"px");this.a.appendChild(a)};function ma(){var a=document.createDocumentFragment();a.appendChild(na(this));a.appendChild(oa(this));a.appendChild(pa(this));a.appendChild(qa(this));document.body.appendChild(a);this.g=[]}function ra(a,b){a.c.onchange=b}function U(a,b,c){b=new T(b,c);a.a.appendChild(b.c());a.g.push(b)}function oa(a){a.f=new P;return a.f.c()}function pa(a){a.c=document.createElement("INPUT");a.c.type="file";Q(a.c,"display","none");return a.c}
function na(a){a.b=new N;O(a.b,new L("Undo"));O(a.b,new L("Redo"));O(a.b,new L("Add image"));return a.b.c()}function qa(a){a.a=document.createElement("DIV");a.a.id="canvas";return a.a};function V(a){this.c=a;this.b=new ma;sa(this)}V.prototype.f=function(){var a=window.event.target,b=new FileReader;b.onload=f(function(){var a=b.result.toString(),d=t(this.c);U(this.b,d,a)},this);b.readAsDataURL(a.files[0])};function sa(a){var b=a.b.b;M(b.a[0],function(){console.log("undo")});M(b.a[1],function(){console.log("redo")});M(b.a[2],f(a.a,a));ra(a.b,f(a.f,a))}V.prototype.a=function(){var a=this.b.f.a.value;if(a){var b=t(this.c);U(this.b,b,a)}else this.b.c.click()};function W(){new V(new fa)}var X=["Sample","start"],Y=e;X[0]in Y||!Y.execScript||Y.execScript("var "+X[0]);for(var Z;X.length&&(Z=X.shift());)X.length||void 0===W?Y[Z]?Y=Y[Z]:Y=Y[Z]={}:Y[Z]=W;})();
