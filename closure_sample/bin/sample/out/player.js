(function(){var e=this;function f(a,b,c){return a.call.apply(a.bind,arguments)}function g(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function h(a,b,c){h=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?f:g;return h.apply(null,arguments)};var l=String.prototype.trim?function(a){return a.trim()}:function(a){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")};function m(a,b){return a<b?-1:a>b?1:0}function aa(a){return String(a).replace(/\-([a-z])/g,function(a,c){return c.toUpperCase()})}function ba(a){var b="\\s";return a.replace(new RegExp("(^"+(b?"|["+b+"]+":"")+")([a-z])","g"),function(a,b,n){return b+n.toUpperCase()})};function r(a,b){this.x=void 0!==a?a:0;this.y=void 0!==b?b:0}r.prototype.clone=function(){return new r(this.x,this.y)};r.prototype.ceil=function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this};r.prototype.floor=function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this};r.prototype.round=function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this};function t(a,b){this.width=a;this.height=b}t.prototype.clone=function(){return new t(this.width,this.height)};t.prototype.ceil=function(){this.width=Math.ceil(this.width);this.height=Math.ceil(this.height);return this};t.prototype.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};t.prototype.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};function u(a,b,c,d){this.left=a;this.top=b;this.width=c;this.height=d}u.prototype.clone=function(){return new u(this.left,this.top,this.width,this.height)};u.prototype.ceil=function(){this.left=Math.ceil(this.left);this.top=Math.ceil(this.top);this.width=Math.ceil(this.width);this.height=Math.ceil(this.height);return this};u.prototype.floor=function(){this.left=Math.floor(this.left);this.top=Math.floor(this.top);this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};
u.prototype.round=function(){this.left=Math.round(this.left);this.top=Math.round(this.top);this.width=Math.round(this.width);this.height=Math.round(this.height);return this};function ca(){var a=new u(200,200,250,250);this.c=new t(a.width,a.height);this.b=new r(a.left,a.top)};function da(){this.b=[]};var v;a:{var w=e.navigator;if(w){var x=w.userAgent;if(x){v=x;break a}}v=""};var y=-1!=v.indexOf("Opera")||-1!=v.indexOf("OPR"),z=-1!=v.indexOf("Trident")||-1!=v.indexOf("MSIE"),ea=-1!=v.indexOf("Edge"),A=-1!=v.indexOf("Gecko")&&!(-1!=v.toLowerCase().indexOf("webkit")&&-1==v.indexOf("Edge"))&&!(-1!=v.indexOf("Trident")||-1!=v.indexOf("MSIE"))&&-1==v.indexOf("Edge"),B=-1!=v.toLowerCase().indexOf("webkit")&&-1==v.indexOf("Edge");function C(){var a=e.document;return a?a.documentMode:void 0}var D;
a:{var E="",F=function(){var a=v;if(A)return/rv\:([^\);]+)(\)|;)/.exec(a);if(ea)return/Edge\/([\d\.]+)/.exec(a);if(z)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(a);if(B)return/WebKit\/(\S+)/.exec(a);if(y)return/(?:Version)[ \/]?(\S+)/.exec(a)}();F&&(E=F?F[1]:"");if(z){var G=C();if(null!=G&&G>parseFloat(E)){D=String(G);break a}}D=E}var H={};
function I(a){if(!H[a]){for(var b=0,c=l(String(D)).split("."),d=l(String(a)).split("."),n=Math.max(c.length,d.length),k=0;0==b&&k<n;k++){var fa=c[k]||"",ga=d[k]||"",ha=RegExp("(\\d*)(\\D*)","g"),ia=RegExp("(\\d*)(\\D*)","g");do{var p=ha.exec(fa)||["","",""],q=ia.exec(ga)||["","",""];if(0==p[0].length&&0==q[0].length)break;b=m(0==p[1].length?0:parseInt(p[1],10),0==q[1].length?0:parseInt(q[1],10))||m(0==p[2].length,0==q[2].length)||m(p[2],q[2])}while(0==b)}H[a]=0<=b}}
var J=e.document,ja=J&&z?C()||("CSS1Compat"==J.compatMode?parseInt(D,10):5):void 0;var K;if(!(K=!A&&!z)){var L;if(L=z)L=9<=Number(ja);K=L}K||A&&I("1.9.1");z&&I("9");function M(a){this.f=a;this.b()}function N(a,b){a.a.onclick=b}M.prototype.c=function(){return this.a};M.prototype.b=function(){this.a=document.createElement("BUTTON");this.a.setAttribute("class","button");this.a.innerHTML=this.f};function O(){this.b();this.a=[]}function P(a,b){a.a.push(b);a.f.appendChild(b.c())}O.prototype.c=function(){return this.f};O.prototype.b=function(){this.f=document.createElement("DIV");this.f.setAttribute("id","toolbar")};function Q(){this.b()}Q.prototype.f=function(){this.a.setAttribute("value","")};Q.prototype.c=function(){return this.a};Q.prototype.b=function(){this.a=document.createElement("INPUT");this.a.id="imageInput";this.a.type="text";this.a.setAttribute("value","\u0412\u0432\u0435\u0434\u0438\u0442\u0435 Url \u0438\u043b\u0438 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0439 \u0430\u0434\u0440\u0435\u0441 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0438");this.a.onfocus=this.f};function R(a,b,c){if("string"==typeof b)(b=S(a,b))&&(a.style[b]=c);else for(var d in b){c=a;var n=b[d],k=S(c,d);k&&(c.style[k]=n)}}var T={};function S(a,b){var c=T[b];if(!c){var d=aa(b),c=d;void 0===a.style[d]&&(d=(B?"Webkit":A?"Moz":z?"ms":y?"O":null)+ba(d),void 0!==a.style[d]&&(c=d));T[b]=c}return c};function U(a,b){this.g=b;this.f=a;this.b()}U.prototype.c=function(){return this.a};U.prototype.b=function(){this.a=document.createElement("DIV");this.a.setAttribute("class","capture");R(this.a,"top",this.f.top+"px");R(this.a,"left",this.f.left+"px");var a=document.createElement("IMG");a.setAttribute("src",this.g);a.setAttribute("alt","\u0442\u0435\u043a\u0441\u0442");R(a,"width",this.f.width+"px");R(a,"height",this.f.height+"px");this.a.appendChild(a)};function ka(){var a=document.createDocumentFragment();a.appendChild(la(this));a.appendChild(ma(this));a.appendChild(na(this));a.appendChild(oa(this));document.body.appendChild(a);this.g=[]}function ma(a){a.f=new Q;return a.f.c()}function na(a){a.c=document.createElement("INPUT");a.c.type="file";R(a.c,"display","none");return a.c}function la(a){a.b=new O;P(a.b,new M("Undo"));P(a.b,new M("Redo"));P(a.b,new M("Add image"));return a.b.c()}
function oa(a){a.a=document.createElement("DIV");a.a.id="canvas";return a.a};function V(a){this.a=a;this.b=new ka;pa(this)}function pa(a){var b=a.b.b;N(b.a[0],function(){console.log("undo")});N(b.a[1],function(){console.log("redo")});N(b.a[2],h(a.c,a))}V.prototype.c=function(){var a=this.b.f.a.value;if(a){var b=new ca;this.a.b.push(b);var c=this.b,a=new U(new u(b.b.x,b.b.y,b.c.width,b.c.height),a);c.a.appendChild(a.c());c.g.push(a)}else this.b.c.click()};function W(){new V(new da)}var X=["Sample","start"],Y=e;X[0]in Y||!Y.execScript||Y.execScript("var "+X[0]);for(var Z;X.length&&(Z=X.shift());)X.length||void 0===W?Y[Z]?Y=Y[Z]:Y=Y[Z]={}:Y[Z]=W;})();
