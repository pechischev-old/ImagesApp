(function(){var e=this;function g(a,b,c){return a.call.apply(a.bind,arguments)}function aa(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function h(a,b,c){h=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?g:aa;return h.apply(null,arguments)};var k=String.prototype.trim?function(a){return a.trim()}:function(a){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")};function l(a,b){return a<b?-1:a>b?1:0}function ba(a){return String(a).replace(/\-([a-z])/g,function(a,c){return c.toUpperCase()})}function ca(a){var b="\\s";return a.replace(new RegExp("(^"+(b?"|["+b+"]+":"")+")([a-z])","g"),function(a,b,m){return b+m.toUpperCase()})};function n(a,b){this.x=void 0!==a?a:0;this.y=void 0!==b?b:0}n.prototype.clone=function(){return new n(this.x,this.y)};n.prototype.ceil=function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this};n.prototype.floor=function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this};n.prototype.round=function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this};function p(a,b){this.width=a;this.height=b}p.prototype.clone=function(){return new p(this.width,this.height)};p.prototype.ceil=function(){this.width=Math.ceil(this.width);this.height=Math.ceil(this.height);return this};p.prototype.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};p.prototype.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};function q(a,b,c,d){this.left=a;this.top=b;this.width=c;this.height=d}q.prototype.clone=function(){return new q(this.left,this.top,this.width,this.height)};q.prototype.ceil=function(){this.left=Math.ceil(this.left);this.top=Math.ceil(this.top);this.width=Math.ceil(this.width);this.height=Math.ceil(this.height);return this};q.prototype.floor=function(){this.left=Math.floor(this.left);this.top=Math.floor(this.top);this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};
q.prototype.round=function(){this.left=Math.round(this.left);this.top=Math.round(this.top);this.width=Math.round(this.width);this.height=Math.round(this.height);return this};function da(){var a=new q(200,200,250,250);this.f=new p(a.width,a.height);this.b=new n(a.left,a.top)};function ea(){this.b=[]}function r(a){var b=new da;a.b.push(b);return new q(b.b.x,b.b.y,b.f.width,b.f.height)};var t;a:{var w=e.navigator;if(w){var x=w.userAgent;if(x){t=x;break a}}t=""};var y=-1!=t.indexOf("Opera")||-1!=t.indexOf("OPR"),z=-1!=t.indexOf("Trident")||-1!=t.indexOf("MSIE"),fa=-1!=t.indexOf("Edge"),A=-1!=t.indexOf("Gecko")&&!(-1!=t.toLowerCase().indexOf("webkit")&&-1==t.indexOf("Edge"))&&!(-1!=t.indexOf("Trident")||-1!=t.indexOf("MSIE"))&&-1==t.indexOf("Edge"),B=-1!=t.toLowerCase().indexOf("webkit")&&-1==t.indexOf("Edge");function C(){var a=e.document;return a?a.documentMode:void 0}var D;
a:{var E="",F=function(){var a=t;if(A)return/rv\:([^\);]+)(\)|;)/.exec(a);if(fa)return/Edge\/([\d\.]+)/.exec(a);if(z)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(a);if(B)return/WebKit\/(\S+)/.exec(a);if(y)return/(?:Version)[ \/]?(\S+)/.exec(a)}();F&&(E=F?F[1]:"");if(z){var G=C();if(null!=G&&G>parseFloat(E)){D=String(G);break a}}D=E}var H={};
function I(a){var b;if(!(b=H[a])){b=0;for(var c=k(String(D)).split("."),d=k(String(a)).split("."),m=Math.max(c.length,d.length),f=0;0==b&&f<m;f++){var ga=c[f]||"",ha=d[f]||"",ia=RegExp("(\\d*)(\\D*)","g"),ja=RegExp("(\\d*)(\\D*)","g");do{var u=ia.exec(ga)||["","",""],v=ja.exec(ha)||["","",""];if(0==u[0].length&&0==v[0].length)break;b=l(0==u[1].length?0:parseInt(u[1],10),0==v[1].length?0:parseInt(v[1],10))||l(0==u[2].length,0==v[2].length)||l(u[2],v[2])}while(0==b)}b=H[a]=0<=b}return b}
var J=e.document,ka=J&&z?C()||("CSS1Compat"==J.compatMode?parseInt(D,10):5):void 0;!A&&!z||z&&9<=Number(ka)||A&&I("1.9.1");z&&I("9");function K(a){this.c=a;this.b()}function L(a,b){a.a.onclick=b}K.prototype.f=function(){return this.a};K.prototype.b=function(){this.a=document.createElement("BUTTON");this.a.setAttribute("class","button");this.a.innerHTML=this.c};function M(){this.b();this.a=[]}function N(a,b){a.a.push(b);a.c.appendChild(b.f())}M.prototype.f=function(){return this.c};M.prototype.b=function(){this.c=document.createElement("DIV");this.c.setAttribute("id","toolbar")};function O(){this.b()}O.prototype.f=function(){return this.a};O.prototype.b=function(){this.a=document.createElement("INPUT");this.a.id="imageInput";this.a.type="text";this.a.setAttribute("placeholder","\u0412\u0432\u0435\u0434\u0438\u0442\u0435 Url \u0438\u043b\u0438 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0439 \u0430\u0434\u0440\u0435\u0441 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0438");this.a.onfocus=h(this.c,this)};O.prototype.c=function(){this.a.setAttribute("value","")};function P(a,b,c){if("string"==typeof b)(b=Q(a,b))&&(a.style[b]=c);else for(var d in b){c=a;var m=b[d],f=Q(c,d);f&&(c.style[f]=m)}}var R={};function Q(a,b){var c=R[b];if(!c){var d=ba(b),c=d;void 0===a.style[d]&&(d=(B?"Webkit":A?"Moz":z?"ms":y?"O":null)+ca(d),void 0!==a.style[d]&&(c=d));R[b]=c}return c};z&&I("9");!B||I("528");A&&I("1.9b")||z&&I("8")||y&&I("9.5")||B&&I("528");A&&!I("8")||z&&I("9");var la="se s sw e w ne n nw".split(" ");function S(a){this.c=a;this.b()}S.prototype.f=function(){return this.a};S.prototype.g=function(){P(this.a,"display","block")};
S.prototype.b=function(){this.a=document.createElement("DIV");this.a.setAttribute("class","border");P(this.a,"width",this.c.width+"px");P(this.a,"height",this.c.height+"px");P(this.a,"display","none");for(var a=0,b=0;2>=b;++b)for(var c=0;2>=c;++c)if(1!=b||1!=c){var d=.5*c*this.c.width,m=.5*b*this.c.height,f=document.createElement("DIV");f.setAttribute("class",la[a]);P(f,"left",d-5+"px");P(f,"top",m-5+"px");P(f,"width","10px");P(f,"height","10px");this.a.appendChild(f);++a}};function T(a,b){this.h=b;this.c=a;this.b();this.g=new S(a);this.a.appendChild(this.g.f());this.a.onfocus=h(this.g.g,this.g)}T.prototype.f=function(){return this.a};
T.prototype.b=function(){this.a=document.createElement("DIV");this.a.setAttribute("class","capture");P(this.a,"top",this.c.top+"px");P(this.a,"left",this.c.left+"px");var a=document.createElement("IMG");a.setAttribute("src",this.h);a.setAttribute("alt","\u0442\u0435\u043a\u0441\u0442");P(a,"width",this.c.width+"px");P(a,"height",this.c.height+"px");this.a.appendChild(a)};function ma(){var a=document.createDocumentFragment();a.appendChild(na(this));a.appendChild(oa(this));a.appendChild(pa(this));a.appendChild(qa(this));document.body.appendChild(a);this.g=[]}function ra(a,b){a.b.onchange=b}function U(a,b,c){b=new T(b,c);a.a.appendChild(b.f());a.g.push(b)}function oa(a){a.c=new O;return a.c.f()}function pa(a){a.b=document.createElement("INPUT");a.b.type="file";a.b.setAttribute("accept","image/*");P(a.b,"display","none");return a.b}
function na(a){a.f=new M;N(a.f,new K("Undo"));N(a.f,new K("Redo"));N(a.f,new K("Add image"));return a.f.f()}function qa(a){a.a=document.createElement("DIV");a.a.id="canvas";return a.a};function V(a){this.f=a;this.b=new ma;sa(this)}V.prototype.c=function(){var a=window.event.target,b=new FileReader;b.onload=h(function(){var a=b.result.toString(),d=r(this.f);U(this.b,d,a)},this);b.readAsDataURL(a.files[0])};function sa(a){var b=a.b.f;L(b.a[0],function(){console.log("undo")});L(b.a[1],function(){console.log("redo")});L(b.a[2],h(a.a,a));ra(a.b,h(a.c,a))}V.prototype.a=function(){var a=this.b.c.a.value;if(a){var b=r(this.f);U(this.b,b,a)}else this.b.b.click()};function W(){new V(new ea)}var X=["Sample","start"],Y=e;X[0]in Y||!Y.execScript||Y.execScript("var "+X[0]);for(var Z;X.length&&(Z=X.shift());)X.length||void 0===W?Y[Z]?Y=Y[Z]:Y=Y[Z]={}:Y[Z]=W;})();
